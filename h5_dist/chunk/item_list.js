(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{"350":function(t,e,n){"use strict";n(2),n(3);var o=n(8),r=function(){function defineProperties(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(t,e,n){return e&&defineProperties(t.prototype,e),n&&defineProperties(t,n),t}}(),i=function get(t,e,n){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,e);if(void 0===o){var r=Object.getPrototypeOf(t);return null===r?void 0:get(r,e,n)}if("value"in o)return o.value;var i=o.get;return void 0!==i?i.call(n):void 0};function _asyncToGenerator(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function step(o,r){try{var i=e[o](r),a=i.value}catch(t){return void n(t)}if(!i.done)return Promise.resolve(a).then(function(t){step("next",t)},function(t){step("throw",t)});t(a)}("next")})}}var a={"WILL_MOUNT":0,"DID_MOUNT":1,"DID_SHOW":2};function withLogin(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.WILL_MOUNT;return void 0!==a[e]?(console.warn("lifeCycle is not in defined types: "+e),function(t){return t}):function withLoginComponent(t){return function(n){function WithLogin(t){return function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,WithLogin),function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(WithLogin.__proto__||Object.getPrototypeOf(WithLogin)).call(this,t))}return function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{"constructor":{"value":t,"enumerable":!1,"writable":!0,"configurable":!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(WithLogin,t),r(WithLogin,[{"key":"componentWillMount","value":function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function _callee(){return regeneratorRuntime.wrap(function _callee$(t){for(;;)switch(t.prev=t.next){case 0:if(e!==a.WILL_MOUNT){t.next=6;break}return t.next=3,this.__autoLogin();case 3:if(t.sent){t.next=6;break}return t.abrupt("return");case 6:i(WithLogin.prototype.__proto__||Object.getPrototypeOf(WithLogin.prototype),"componentWillMount",this)&&i(WithLogin.prototype.__proto__||Object.getPrototypeOf(WithLogin.prototype),"componentWillMount",this).call(this);case 7:case"end":return t.stop()}},_callee,this)}));return function componentWillMount(){return t.apply(this,arguments)}}()},{"key":"componentDidMount","value":function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(){return regeneratorRuntime.wrap(function _callee2$(t){for(;;)switch(t.prev=t.next){case 0:if(e!==a.DID_MOUNT){t.next=6;break}return t.next=3,this.__autoLogin();case 3:if(t.sent){t.next=6;break}return t.abrupt("return");case 6:i(WithLogin.prototype.__proto__||Object.getPrototypeOf(WithLogin.prototype),"componentDidMount",this)&&i(WithLogin.prototype.__proto__||Object.getPrototypeOf(WithLogin.prototype),"componentDidMount",this).call(this);case 7:case"end":return t.stop()}},_callee2,this)}));return function componentDidMount(){return t.apply(this,arguments)}}()},{"key":"componentDidShow","value":function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function _callee3(){return regeneratorRuntime.wrap(function _callee3$(t){for(;;)switch(t.prev=t.next){case 0:if(e!==a.DID_SHOW){t.next=6;break}return t.next=3,this.__autoLogin();case 3:if(t.sent){t.next=6;break}return t.abrupt("return");case 6:i(WithLogin.prototype.__proto__||Object.getPrototypeOf(WithLogin.prototype),"componentDidShow",this)&&i(WithLogin.prototype.__proto__||Object.getPrototypeOf(WithLogin.prototype),"componentDidShow",this).call(this);case 7:case"end":return t.stop()}},_callee3,this)}));return function componentDidShow(){return t.apply(this,arguments)}}()},{"key":"__autoLogin","value":function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function _callee4(){return regeneratorRuntime.wrap(function _callee4$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.a.autoLogin(this);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},_callee4,this)}));return function __autoLogin(){return t.apply(this,arguments)}}()}]),WithLogin}()}}var c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},s=function(){function defineProperties(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(t,e,n){return e&&defineProperties(t.prototype,e),n&&defineProperties(t,n),t}}();function withPager(t){var e,n;return e=function(e){function WithPagerComponent(t){!function withPager_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,WithPagerComponent);var e=function withPager_possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(WithPagerComponent.__proto__||Object.getPrototypeOf(WithPagerComponent)).call(this,t));n.call(e);var o=t||{},r=o.pageSize,i=void 0===r?10:r,a=o.pageNo,c=void 0===a?0:a,s=o.pageTotal,u={"hasNext":!0,"isLoading":!1,"total":void 0===s?0:s,"page_no":c,"page_size":i};return e.state.page=u,e}return function withPager_inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{"constructor":{"value":t,"enumerable":!1,"writable":!0,"configurable":!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(WithPagerComponent,t),s(WithPagerComponent,[{"key":"resetPage","value":function resetPage(){var t=c({},this.state.page||{},{"page_no":0,"total":0,"isLoading":!1,"hasNext":!0});this.setState({"page":t})}}]),WithPagerComponent}(),n=function _initialiseProps(){var t=this;this.nextPage=function withPager_asyncToGenerator(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function step(o,r){try{var i=e[o](r),a=i.value}catch(t){return void n(t)}if(!i.done)return Promise.resolve(a).then(function(t){step("next",t)},function(t){step("throw",t)});t(a)}("next")})}}(regeneratorRuntime.mark(function _callee(){var e,n,o,r,i,a;return regeneratorRuntime.wrap(function _callee$(s){for(;;)switch(s.prev=s.next){case 0:if((e=t.state.page).hasNext){s.next=3;break}return s.abrupt("return");case 3:return e.isLoading=!0,t.setState({"page":e}),n=e.page_no,o=e.page_size,r=n+1,s.next=9,t.fetch({"page_no":r,"page_size":o});case 9:i=s.sent,(!(a=i.total)||r>=Math.ceil(+a/o))&&(e.hasNext=!1),t.setState({"page":c({},e,{"total":a,"page_no":r,"isLoading":!1})});case 13:case"end":return s.stop()}},_callee,t)}))},e}var u=n(27),l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t};function withBackToTop(t){return function(e){function WithBackToTopComponent(t){!function withBackToTop_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,WithBackToTopComponent);var e=function withBackToTop_possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(WithBackToTopComponent.__proto__||Object.getPrototypeOf(WithBackToTopComponent)).call(this,t));return e.scrollBackToTop=function(){e.setState({"scrollTop":0},function(){e.setState({"scrollTop":null})})},e.handleScroll=function(t){var n=t.detail,o=n.scrollTop;n.scrollHeight<600||(o>300&&!e.state.showBackToTop?(u.i.debug("[BackToTop] showBackToTop, scrollTop: "+o),e.setState({"showBackToTop":!0})):e.state.showBackToTop&&o<=300&&(u.i.debug("[BackToTop] hideBackToTop, scrollTop: "+o),e.setState({"showBackToTop":!1})))},e.state=l({},e.state,{"scrollTop":null,"showBackToTop":!1}),e}return function withBackToTop_inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{"constructor":{"value":t,"enumerable":!1,"writable":!0,"configurable":!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(WithBackToTopComponent,t),WithBackToTopComponent}()}n.d(e,"b",function(){return withLogin}),n.d(e,"c",function(){return withPager}),n.d(e,"a",function(){return withBackToTop})},"485":function(t,e,n){},"598":function(t,e,n){"use strict";n.r(e);var o,r=n(2),i=n.n(r),a=n(3),c=n.n(a),s=n(613),u=n(612),l=n(350),p=n(347),f=n(28),h=n(27),g=(n(485),Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t}),_=function(){function defineProperties(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(t,e,n){return e&&defineProperties(t.prototype,e),n&&defineProperties(t,n),t}}();function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}e.default=Object(l.c)(o=Object(l.a)(o=function(t){function List(t){!function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,List);var e=function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(List.__proto__||Object.getPrototypeOf(List)).call(this,t));return e.handleFilterChange=function(t){var n=t.current,o=t.sort,r=g({},e.state.query,{"goodsSort":0===n?null:1===n?1:o>0?3:2});(n!==e.state.curFilterIdx||n===e.state.curFilterIdx&&r.goodsSort!==e.state.query.goodsSort)&&(e.resetPage(),e.setState({"list":[]})),e.setState({"curFilterIdx":n,"query":r},function(){e.nextPage()})},e.handleListTypeChange=function(){var t="grid"===e.state.listType?"default":"grid";e.setState({"listType":t})},e.handleClickItem=function(t){var e="/pages/item/espier-detail?id="+t.item_id;i.a.navigateTo({"url":e})},e.state=g({},e.state,{"curFilterIdx":0,"filterList":[{"title":"综合"},{"title":"销量"},{"title":"价格","sort":-1}],"query":null,"list":[],"listType":""}),e}return function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{"constructor":{"value":t,"enumerable":!1,"writable":!0,"configurable":!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(List,r["Component"]),_(List,[{"key":"componentDidMount","value":function componentDidMount(){var t=this;this.setState({"query":{"keywords":"","item_type":"normal","is_point":"false","approve_status":"onsale,only_show","category":this.$router.params.cat_id}},function(){t.nextPage()})}},{"key":"fetch","value":function(){var t=function _asyncToGenerator(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function step(o,r){try{var i=e[o](r),a=i.value}catch(t){return void n(t)}if(!i.done)return Promise.resolve(a).then(function(t){step("next",t)},function(t){step("throw",t)});t(a)}("next")})}}(regeneratorRuntime.mark(function _callee(t){var e,n,o,r,i,a,c;return regeneratorRuntime.wrap(function _callee$(s){for(;;)switch(s.prev=s.next){case 0:return e=t.page_no,n=t.page_size,o=g({},this.state.query,{"page":e,"pageSize":n}),s.next=4,f.a.item.search(o);case 4:return r=s.sent,i=r.list,a=r.total_count,c=Object(h.k)(i,{"img":"pics[0]","item_id":"item_id","title":"itemName","desc":"brief","price":function price(t){return(t.price/100).toFixed(2)},"market_price":function market_price(t){return(t.market_price/100).toFixed(2)}}),this.setState({"list":[].concat(_toConsumableArray(this.state.list),_toConsumableArray(c)),"query":o}),s.abrupt("return",{"total":a});case 10:case"end":return s.stop()}},_callee,this)}));return function fetch(e){return t.apply(this,arguments)}}()},{"key":"render","value":function render(){var t=this,e=this.state,n=e.list,o=e.listType,r=e.curFilterIdx,i=e.filterList,a=e.showBackToTop,l=e.scrollTop,f=e.page;return c.a.createElement(s.a,{"className":"page-goods-list"},c.a.createElement(s.a,{"className":"goods-list__toolbar"},c.a.createElement(p.f,{"title":"商城","leftIconType":"chevron-left","fixed":"true"}),c.a.createElement(p.h,null),c.a.createElement(p.c,{"className":"goods-list__tabs","current":r,"list":i,"onChange":this.handleFilterChange},c.a.createElement(s.a,{"className":"at-icon at-icon-bullet-list","onClick":this.handleListTypeChange}))),c.a.createElement(u.a,{"className":"goods-list__scroll","scrollY":!0,"scrollTop":l,"scrollWithAnimation":!0,"onScroll":this.handleScroll,"onScrollToLower":this.nextPage},c.a.createElement(s.a,{"className":"goods-list goods-list__type-"+o},n.map(function(e){return c.a.createElement(p.d,{"key":e.item_id,"info":e,"onClick":function onClick(){return t.handleClickItem(e)}})})),f.isLoading?c.a.createElement(p.e,null,"正在加载..."):null),c.a.createElement(p.b,{"show":a,"onClick":this.scrollBackToTop}))}},{"key":"componentDidShow","value":function componentDidShow(){}}]),List}())||o)||o}}]);