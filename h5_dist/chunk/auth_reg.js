(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{"457":function(e,t,a){},"575":function(e,t,a){"use strict";a.r(t);var n,r=a(2),i=a.n(r),o=a(3),s=a.n(o),c=a(595),l=a(208),u=a(557),m=a(28),h=a(47),p=a(592),d=a(552),f=a(551),g=a(349),b=a(31),y=a(6),k=a(32),v=(a(457),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}),_=function(){function defineProperties(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}();function _asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,a){return function step(n,r){try{var i=t[n](r),o=i.value}catch(e){return void a(e)}if(!i.done)return Promise.resolve(o).then(function(e){step("next",e)},function(e){step("throw",e)});e(o)}("next")})}}t.default=Object(h.connect)(function(e){return{"land_params":e.user.land_params}},function(){return{}})(n=function(e){function Reg(e){var t=this;!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Reg);var a,n,r=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(Reg.__proto__||Object.getPrototypeOf(Reg)).call(this,e));return r.handleClickImgcode=_asyncToGenerator(regeneratorRuntime.mark(function _callee(){var e;return regeneratorRuntime.wrap(function _callee$(t){for(;;)switch(t.prev=t.next){case 0:return e={"type":"sign"},t.next=3,k.a.user.regImg(e).then(function(e){r.setState({"imgInfo":e})});case 3:case"end":return t.stop()}},_callee,t)})),r.handleSubmit=(a=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(e){var a,n;return regeneratorRuntime.wrap(function _callee2$(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.detail.value,(n=v({},r.state.info,a)).mobile&&/1\d{10}/.test(n.mobile)){t.next=4;break}return t.abrupt("return",y.a.toast("请输入正确的手机号"));case 4:if(n.vcode){t.next=6;break}return t.abrupt("return",y.a.toast("请输入验证码"));case 6:if(n.password){t.next=8;break}return t.abrupt("return",y.a.toast("请输入密码"));case 8:return r.state.list.map(function(e){return e.is_required?!(!e.is_required||!n[e.key])||y.a.toast("请输入"+e.name):null}),t.next=11,k.a.user.reg(n).then(function(e){y.a.setAuthToken(e.token.data.token),i.a.showToast({"title":"注册成功","icon":"none"}).then(function(){setTimeout(function(){i.a.redirectTo({"url":"/pages/member/index"})},1500)})}).catch(function(e){return y.a.toast(""+e.res.data.error.message),!1});case 11:case"end":return t.stop()}},_callee2,t)})),function(e){return a.apply(this,arguments)}),r.handleChange=function(e,t){var a=r.state,n=a.info,i=a.list;n[e]=t,"mobile"===e&&11===t.length&&0===r.count&&(r.count=1,r.setState({"imgVisible":!0})),Object(b.h)(t)?i.map(function(a){a.key===e&&(a.value=t)}):i.map(function(a){a.key===e&&(n[e]=t.detail.value),"birthday"===e?a.key===e&&(a.value=t.detail.value):a.key===e&&(a.items?a.value=a.items[t.detail.value]:a.value=t.detail.value)}),r.setState({"list":i}),"sex"===e&&("男"===n[e]?n[e]=1:n[e]=2)},r.handleClickIconpwd=function(){var e=r.state.isVisible;r.setState({"isVisible":!e})},r.handleErrorToastClose=function(){y.a.closeToast()},r.handleTimerStart=(n=_asyncToGenerator(regeneratorRuntime.mark(function _callee3(e){var a,n,i,o,s;return regeneratorRuntime.wrap(function _callee3$(t){for(;;)switch(t.prev=t.next){case 0:if(!r.state.isTimerStart){t.next=2;break}return t.abrupt("return");case 2:if(a=r.state.info,n=a.mobile,i=a.yzm,o=r.state.imgInfo,/1\d{10}/.test(n)){t.next=6;break}return t.abrupt("return",y.a.toast("请输入正确的手机号"));case 6:if(11===n.length&&i){t.next=8;break}return t.abrupt("return",y.a.toast("请输入手机号和图形验证码"));case 8:return s={"type":"sign","mobile":n,"yzm":i,"token":o.imageToken},t.next=11,k.a.user.regSmsCode(s).then(function(){y.a.toast("发送成功")}).catch(function(e){return y.a.toast(""+e.res.data.error.message),!1});case 11:e();case 12:case"end":return t.stop()}},_callee3,t)})),function(e){return n.apply(this,arguments)}),r.handleUpdateTimer=function(e){var t=e+"s";r.setState({"timerMsg":t})},r.handleTimerStop=function(){r.setState({"timerMsg":"重新获取"})},r.handleClickAgreement=function(){console.log("用户协议")},r.state={"info":{},"timerMsg":"获取验证码","isVisible":!1,"list":[],"imgVisible":!1,"imgInfo":{}},r}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Reg,r["Component"]),_(Reg,[{"key":"componentDidMount","value":function componentDidMount(){this.setState({"info":{"user_type":"local","uid":this.props.land_params.user_id}}),this.fetch()}},{"key":"fetch","value":function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function _callee4(){var e,t;return regeneratorRuntime.wrap(function _callee4$(a){for(;;)switch(a.prev=a.next){case 0:return e=[],a.next=3,k.a.user.regParam();case 3:t=a.sent,Object.keys(t).forEach(function(a){t[a].is_open&&("sex"===a&&(t[a].items=["男","女"]),"birthday"===a&&(t[a].items=[]),e.push({"key":a,"name":t[a].name,"is_required":t[a].is_required,"items":t[a].items?t[a].items:null}))}),this.handleClickImgcode(),this.setState({"list":e}),this.count=0;case 8:case"end":return a.stop()}},_callee4,this)}));return function fetch(){return e.apply(this,arguments)}}()},{"key":"render","value":function render(){var e=this,t=this.state,a=t.info,n=t.timerMsg,r=t.isVisible,i=t.list,o=t.imgVisible,h=t.imgInfo;return s.a.createElement(c.a,{"className":"auth-reg"},s.a.createElement(p.a,{"onSubmit":this.handleSubmit},s.a.createElement(c.a,{"className":"sec auth-reg__form"},s.a.createElement(d.a,{"title":"手机号码","name":"mobile","maxLength":11,"value":a.mobile,"placeholder":"请输入手机号码","onFocus":this.handleErrorToastClose,"onChange":this.handleChange.bind(this,"mobile")}),o?s.a.createElement(d.a,{"title":"图片验证码","name":"yzm","value":a.yzm,"placeholder":"请输入图片验证码","onFocus":this.handleErrorToastClose,"onChange":this.handleChange.bind(this,"yzm")},s.a.createElement(l.a,{"src":""+h.imageData,"onClick":this.handleClickImgcode})):null,s.a.createElement(d.a,{"title":"验证码","name":"vcode","value":a.vcode,"placeholder":"请输入验证码","onFocus":this.handleErrorToastClose,"onChange":this.handleChange.bind(this,"vcode")},s.a.createElement(g.o,{"onStart":this.handleTimerStart,"onUpdateTimer":this.handleUpdateTimer,"onStop":this.handleTimerStop,"timerMsg":n})),s.a.createElement(d.a,{"title":"密码","name":"password","type":r?"text":"password","value":a.password,"placeholder":"请输入密码","onFocus":this.handleErrorToastClose,"onChange":this.handleChange.bind(this,"password")},r?s.a.createElement(c.a,{"className":"sp-icon sp-icon-yanjing icon-pwd","onClick":this.handleClickIconpwd}," "):s.a.createElement(c.a,{"className":"sp-icon sp-icon-icon6 icon-pwd","onClick":this.handleClickIconpwd}," ")),i.map(function(t,a){return s.a.createElement(c.a,{"key":a},t.items?s.a.createElement(c.a,{"className":"page-section"},s.a.createElement(c.a,{"key":a},"birthday"===t.key?s.a.createElement(u.a,{"mode":"date","onChange":e.handleChange.bind(e,""+t.key)},s.a.createElement(c.a,{"className":"picker"},s.a.createElement(c.a,{"className":"picker__title"},t.name),s.a.createElement(m.a,{"className":Object(b.a)(t.value?"pick-value":"pick-value-null")},t.value?t.value:"请选择"+t.name))):s.a.createElement(u.a,{"mode":"selector","range":t.items,"key":a,"data-item":t,"onChange":e.handleChange.bind(e,""+t.key)},s.a.createElement(c.a,{"className":"picker"},s.a.createElement(c.a,{"className":"picker__title"},t.name),s.a.createElement(m.a,{"className":Object(b.a)(t.value?"pick-value":"pick-value-null")},t.value?t.value:"请选择"+t.name))))):s.a.createElement(c.a,{"key":a},s.a.createElement(d.a,{"key":a,"title":t.name,"name":""+t.key,"placeholder":"请输入"+t.name,"value":t.value,"onFocus":e.handleErrorToastClose,"onChange":e.handleChange.bind(e,""+t.key)})))})),s.a.createElement(c.a,{"className":"btns"},s.a.createElement(f.a,{"type":"primary","onClick":this.handleSubmit,"formType":"submit"},"同意协议并注册"),s.a.createElement(c.a,{"className":"accountAgreement"},"已阅读并同意",s.a.createElement(m.a,{"className":"accountAgreement__text","onClick":this.handleClickAgreement.bind(this)},"《用户协议》")))),s.a.createElement(g.m,null))}},{"key":"componentDidShow","value":function componentDidShow(){}}]),Reg}())||n}}]);