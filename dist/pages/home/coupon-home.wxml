<block>
    <view class="coupon-list">
        <nav-bar title="优惠券列表" __triggerObserer="{{ _triggerObserer }}" leftIconType="chevron-left" fixed="true"></nav-bar>
        <scroll-view scroll-y="{{true}}" class="home_coupon-list__scroll" bindscrolltolower="nextPage">
            <view class="coupon-list-ticket">
                <view class="coupon-item" wx:key="idx" wx:for="{{loopArray0}}" wx:for-item="item" wx:for-index="idx">
                    <block wx:if="{{item.$original.card_type === 'cash'}}">
                        <view class="{{item.$loopState__temp2}}">
                            <view class="coupon-item___number">￥<text class="coupon-item___number_text">{{item.$original.reduce_cost / 100}}</text>
                            </view>
                            <view class="coupon-item___info">满{{item.$original.least_cost > 0 ? item.$original.least_cost / 100 : 0.01}}可用</view>
                        </view>
                    </block>
                    <block wx:if="{{item.$original.card_type === 'gift'}}">
                        <view class="{{item.$loopState__temp4}}">
                            <view class="coupon-item___number">兑换券</view>
                        </view>
                    </block>
                    <block wx:if="{{item.$original.card_type === 'discount'}}">
                        <view class="{{item.$loopState__temp6}}">
                            <view class="coupon-item___number"><text class="coupon-item___number_text">{{(100 - item.$original.discount) / 10}}</text>折</view>
                            <view class="coupon-item___info">满{{item.$original.least_cost > 0 ? item.$original.least_cost / 100 : 0.01}}可用</view>
                        </view>
                    </block>
                    <view class="coupon-item__content">
                        <view class="coupon-item___description"><text>{{item.$original.title}}</text>
                            <view class="coupon-item___used">
                                <block wx:if="{{item.$original.getted !== 1 && item.$original.getted !== 2}}"><text class="btn-receive" bindtap="handleGetCard" data-e-tap-so="this" data-e-tap-a-a="{{item.$original.card_id}}" data-e-tap-a-b="{{idx}}">立即领取</text>
                                </block>
                                <block wx:if="{{item.$original.getted === 1}}"><text>已领取</text>
                                </block>
                                <block wx:if="{{item.$original.getted === 2}}"><text>领完了</text>
                                </block>
                            </view>
                        </view>
                        <block>
                            <block wx:if="{{item.$original.end_date}}">
                                <view class="coupon-item___time">有效期至 <text>{{item.$original.end_date}}</text>
                                </view>
                            </block>
                            <block wx:else>
                                <view class="coupon-item___time">有效期: 领取后<text>{{item.$original.fixed_term}}</text>天有效</view>
                            </block>
                        </block>
                    </view>
                </view>
                <block wx:if="{{page.isLoading}}">
                    <loading __triggerObserer="{{ _triggerObserer }}">正在加载...</loading>
                </block>
                <block wx:if="{{!page.isLoading && !page.hasNext && !list.length}}">
                    <sp-note img="trades_empty.png" __triggerObserer="{{ _triggerObserer }}">赶快去添加吧~</sp-note>
                </block>
            </view>
        </scroll-view>
        <sp-toast __triggerObserer="{{ _triggerObserer }}"></sp-toast>
    </view>
</block>