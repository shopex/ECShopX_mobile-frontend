<block>
    <block wx:if="{{!info}}">
        <loading __triggerObserer="{{ _triggerObserer }}"></loading>
    </block>
    <view class="page-goods-detail" wx:else>
        <nav-bar title="{{info.item_name}}" __triggerObserer="{{ _triggerObserer }}" leftIconType="chevron-left" fixed="true"></nav-bar>
        <scroll-view class="goods-detail__wrap" scroll-y="{{true}}" scroll-top="{{scrollTop}}" scroll-with-animation="{{true}}" bindscroll="handleScroll">
            <view class="goods-imgs__wrap">
                <swiper class="goods-imgs__swiper" indicator-dots="{{true}}" current="{{curImgIdx}}" bindchange="handleSwiperChange">
                    <swiper-item wx:key="idx" wx:for="{{imgs}}" wx:for-item="img" wx:for-index="idx">
                        <item-img src="{{img}}" __triggerObserer="{{ _triggerObserer }}"></item-img>
                    </swiper-item>
                </swiper>
            </view>
            <block wx:if="{{!info.nospec && sixSpecImgsDict.length}}">
                <view class="goods-sec-specs">
                    <scroll-view class="specs-scroller" scroll-x="{{true}}">
                        <view class="specs-imgs"><text>{{sixSpecImgsDict.length}}色可选</text>
                            <image class="{{item.$loopState__temp2}}" src="{{item.$original.url}}" wx:key="$original.specValueId" mode="aspectFill" bindtap="handleSepcImgClick" wx:for="{{loopArray0}}" wx:for-item="item" wx:for-index="index" data-e-tap-so="this" data-e-tap-a-a="{{index}}"></image>
                        </view>
                    </scroll-view>
                </view>
            </block>
            <block wx:if="{{timer}}">
                <view class="goods-timer">
                    <view class="goods-timer__hd">
                        <view class="goods-prices">
                            <price unit="cent" __triggerObserer="{{ _triggerObserer }}" symbol="{{info.cur.symbol}}" value="{{info.price}}"></price>
                            <price unit="cent" __triggerObserer="{{ _triggerObserer }}" className="goods-prices__market" symbol="{{info.cur.symbol}}" value="{{info.mkt_price}}"></price>
                            <view class="goods-prices__ft"><text class="goods-prices__type">团购</text><text class="goods-prices__rule">{{info.group_activity.person_num}}人团</text>
                            </view>
                        </view>
                    </view>
                    <view class="goods-timer__bd"><text class="goods-timer__label">距结束还剩</text>
                        <at-countdown isShowDay="{{true}}" __triggerObserer="{{ _triggerObserer }}" day="{{timer.dd}}" hours="{{timer.hh}}" minutes="{{timer.mm}}" seconds="{{timer.ss}}"></at-countdown>
                    </view>
                </view>
            </block>
            <view class="goods-hd">
                <view class="goods-title__wrap"><text class="goods-title">{{info.item_name}}</text><text class="goods-title__desc">{{info.brief}}</text>
                </view>
                <block wx:if="{{marketing === 'normal'}}">
                    <view class="goods-prices__wrap">
                        <view class="goods-prices">
                            <price primary="{{true}}" __triggerObserer="{{ _triggerObserer }}" unit="cent" value="{{info.price}}"></price>
                        </view>
                    </view>
                </block>
            </view>
            <block wx:if="{{isPromoter}}">
                <view class="goods-income">
                    <view class="sp-icon sp-icon-jifen"></view><text>预计收益：{{anonymousState__temp3}}</text>
                </view>
            </block>
            <block wx:if="{{promotion_activity && promotion_activity.length > 0}}">
                <view class="goods-sec-specs">
                    <view class="goods-sec-specs__activity">
                        <view wx:key="marketing_id" class="goods-sec-specs__activity-item" wx:for="{{promotion_activity}}" wx:for-item="item" wx:for-index="_anonIdx2">
                            <view class="promotion-title">以下优惠可参与{{item.join_limit}}次</view><text class="goods-sec-specs__activity-label promotion-text">【{{item.promotion_tag}}】</text><text class="promotion-text">{{item.marketing_name}}</text>
                            <view class="promotion-rule-content"><text class="promotion-rule-content__text">活动时间：{{item.start_date}}~{{item.end_date}}</text><text class="promotion-rule-content__text">活动规则：{{item.condition_rules}}</text>
                            </view>
                            <block wx:if="{{item.promotion_tag === '满赠' && item.gifts}}">
                                <view>
                                    <view class="promotion-goods" wx:for="{{item.gifts}}" wx:for-item="g_item" wx:for-index="_anonIdx"><text class="promotion-goods__tag">【赠品】</text><text class="promotion-goods__name">{{g_item.gift.item_name}}</text><text class="promotion-goods__num">x{{g_item.gift.gift_num}}</text>
                                    </view>
                                </view>
                            </block>
                        </view>
                    </view>
                </view>
            </block>
            <block wx:if="{{promotion_package}}">
                <sp-cell className="goods-sec-specs" __triggerObserer="{{ _triggerObserer }}" isLink="{{true}}" title="优惠组合" bindonclick="handlePackageClick" value="{{anonymousState__temp4}}" __fn_onClick="{{true}}"></sp-cell>
            </block>{{itemParams}}
            <block wx:if="{{!info.nospec}}">
                <sp-cell className="goods-sec-specs" __triggerObserer="{{ _triggerObserer }}" isLink="{{true}}" title="规格" bindonclick="handleBuyBarClick" value="{{curSku ? curSku.propsText : '请选择'}}" __fn_onClick="{{true}}" data-e-onclick-so="this" data-e-onclick-a-a="{{buyPanelType}}"></sp-cell>
            </block>
            <block wx:if="{{store}}">
                <view class="goods-sec-specs store-info">
                    <view class="view-flex view-flex-middle">
                        <image class="store-brand" src="{{store.imgUrl || 'https://fakeimg.pl/120x120/EFEFEF/CCC/?text=brand&font=lobster'}}" mode="aspectFit"></image>
                        <view>
                            <view class="store-name">{{store.name}}</view>
                        </view>
                    </view>
                    <view class="view-flex">
                        <view class="view-flex-item">
                            <view class="store-attention-btn">关注店铺</view>
                        </view>
                        <view class="view-flex-item">
                            <view class="store-enter-btn" bindtap="handleClickLink">进入店铺</view>
                        </view>
                    </view>
                </view>
            </block>
            <block>
                <block wx:if="{{anonymousState__temp6}}">
                    <view class="wgts-wrap__cont">
                        <view class="wgt-wrap" wx:key="idx" wx:for="{{desc}}" wx:for-item="item" wx:for-index="idx">
                            <block wx:if="{{item.name === 'film'}}">
                                <wgt-film info="{{item}}" __triggerObserer="{{ _triggerObserer }}"></wgt-film>
                            </block>
                            <block wx:if="{{item.name === 'slider'}}">
                                <wgt-slider info="{{item}}" __triggerObserer="{{ _triggerObserer }}" width="{{screenWidth}}"></wgt-slider>
                            </block>
                            <block wx:if="{{item.name === 'writing'}}">
                                <wgt-writing info="{{item}}" __triggerObserer="{{ _triggerObserer }}"></wgt-writing>
                            </block>
                            <block wx:if="{{item.name === 'heading'}}">
                                <wgt-heading info="{{item}}" __triggerObserer="{{ _triggerObserer }}"></wgt-heading>
                            </block>
                            <block wx:if="{{item.name === 'goods'}}">
                                <wgt-goods info="{{item}}" __triggerObserer="{{ _triggerObserer }}"></wgt-goods>
                            </block>
                        </view>
                    </view>
                </block>
                <block wx:else>
                    <sp-html-content className="goods-detail__content" __triggerObserer="{{ _triggerObserer }}" content="{{desc}}"></sp-html-content>
                </block>
            </block>
        </scroll-view>
        <float-menus __triggerObserer="{{ _triggerObserer }}">
            <float-menu-item iconPrefixClass="in-icon" __triggerObserer="{{ _triggerObserer }}" icon="fenxiang1" openType="share" bindonclick="handleShare" __fn_onClick="{{true}}"></float-menu-item>
            <float-menu-item iconPrefixClass="in-icon" __triggerObserer="{{ _triggerObserer }}" icon="kefu" openType="contact" sessionFrom="{{sessionFrom}}"></float-menu-item>
            <float-menu-item iconPrefixClass="in-icon" __triggerObserer="{{ _triggerObserer }}" icon="back-top" hide="{{anonymousState__temp5}}" bindonclick="scrollBackToTop" __fn_onClick="{{true}}"></float-menu-item>
        </float-menus>
        <block>
            <block wx:if="{{info.distributor_sale_status && hasStock && startSecKill}}">
                <goods-buy-toolbar info="{{info}}" __triggerObserer="{{ _triggerObserer }}" type="{{marketing}}" cartCount="{{cartCount}}" bindonfavitem="handleMenuClick" bindonclickaddcart="handleBuyBarClick" bindonclickfastbuy="handleBuyBarClick" __fn_onFavItem="{{true}}" data-e-onfavitem-so="this" data-e-onfavitem-a-a="fav" __fn_onClickAddCart="{{true}}" data-e-onclickaddcart-so="this" data-e-onclickaddcart-a-a="cart" __fn_onClickFastBuy="{{true}}" data-e-onclickfastbuy-so="this" data-e-onclickfastbuy-a-a="fastbuy"></goods-buy-toolbar>
            </block>
            <block wx:else>
                <goods-buy-toolbar info="{{info}}" __triggerObserer="{{ _triggerObserer }}" customRender="{{true}}" cartCount="{{cartCount}}" type="{{marketing}}">
                    <view class="goods-buy-toolbar__btns" style="width: 60%; text-align: center">
                        <block>
                            <block wx:if="{{!startSecKill}}"><text>活动即将开始</text>
                            </block>
                            <block wx:else><text>当前商品无货</text>
                            </block>
                        </block>
                    </view>
                </goods-buy-toolbar>
            </block>
        </block>
        <block wx:if="{{info}}">
            <goods-buy-panel info="{{info}}" __triggerObserer="{{ _triggerObserer }}" type="{{buyPanelType}}" isOpened="{{showBuyPanel}}" bindonclose="anonymousFunc0" bindonchange="handleSkuChange" bindonaddcart="handleBuyAction" bindonfastbuy="handleBuyAction" __fn_onClose="{{true}}" __fn_onChange="{{true}}" __fn_onAddCart="{{true}}" data-e-onaddcart-so="this" data-e-onaddcart-a-a="cart" __fn_onFastbuy="{{true}}" data-e-onfastbuy-so="this" data-e-onfastbuy-a-a="fastbuy"></goods-buy-panel>
        </block>
        <sp-toast __triggerObserer="{{ _triggerObserer }}"></sp-toast>
    </view>
</block>